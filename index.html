<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2e7d32">
    <title>Medición de Alturas - Cámara</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Estilos CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="icons/icon-192.png">
</head>
<body>
    <div class="container">
        <!-- Pantalla de inicio -->
        <div id="startupScreen" class="startup-screen">
            <div style="font-size: 48px; margin-bottom: 20px;">🌲</div>
            <h2>Medición de Alturas Forestales</h2>
            <p>Mide alturas de árboles usando la cámara de tu dispositivo con distancia horizontal fija</p>
            <button onclick="initializeApp()" class="btn btn-primary" style="padding: 15px 30px;">
                <i class="material-icons">camera_alt</i>
                Iniciar Aplicación
            </button>
        </div>

        <!-- Aplicación principal -->
        <div id="mainApp" style="display: none;">
            <div class="header">
                <h1>
                    <i class="material-icons">height</i>
                    Medición de Alturas
                </h1>
            </div>

            <div id="cameraContainer" style="display: none;">
                <video id="cameraView" autoplay playsinline></video>
                <!-- Mira/Retícula -->
                <div id="crosshair">
                    <div id="crosshair-center"></div>
                </div>
                <!-- Indicador de altura en tiempo real -->
                <div id="liveHeightIndicator">
                    <span id="liveHeight">0.0</span> m
                </div>
                <div id="cameraOverlay">
                    <div class="angle-indicator">
                        Ángulo: <span id="angleDisplay">0°</span>
                    </div>
                </div>
            </div>

            <!-- Modo sin cámara -->
            <div id="noCameraMode" class="no-camera" style="display: none;">
                <i class="material-icons">videocam_off</i>
                <h3>Cámara no disponible</h3>
                <p>Para usar esta aplicación necesitas una cámara y sensores de orientación.</p>
                <button onclick="requestCamera()" class="btn btn-primary">
                    <i class="material-icons">refresh</i>
                    Intentar nuevamente
                </button>
            </div>

            <div id="controls">
                <div class="info-panel">
                    <div class="info-group">
                        <div class="info-label">Distancia:</div>
                        <div class="info-value"><span id="currentDistance">10</span> m</div>
                    </div>
                    <div class="info-group">
                        <div class="info-label">Árbol:</div>
                        <div class="info-value" id="treeCount">1</div>
                    </div>
                    <div class="info-group">
                        <div class="info-label">Puntos:</div>
                        <div class="info-value" id="pointCount">0</div>
                    </div>
                </div>

                <div class="info-group status-group">
                    <div class="info-label">Estado:</div>
                    <div class="info-value" id="statusIndicator">Listo</div>
                </div>

                <div class="distance-container">
                    <label>Distancia horizontal:</label>
                    <input type="number" id="distanceInput" value="10" min="1" max="50" step="0.5">
                    <span>metros</span>
                </div>

                <div class="button-group">
                    <button onclick="startMeasurement()" class="btn btn-primary">
                        <i class="material-icons">play_arrow</i>
                        Iniciar Medición
                    </button>
                    <button onclick="capturePoint()" class="btn btn-secondary">
                        <i class="material-icons">add_location</i>
                        Capturar Punto
                    </button>
                </div>

                <button onclick="newTree()" class="btn btn-warning">
                    <i class="material-icons">autorenew</i>
                    Nueva Medición
                </button>
                
                <!-- Control de tamaño de mira -->
                <div class="crosshair-controls">
                    <label>Tamaño de mira:</label>
                    <input type="range" id="crosshairSize" min="40" max="100" value="60" 
                           oninput="adjustCrosshairSize(this.value)">
                </div>

                <div id="measurementsList" class="measurements-list"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="script.js"></script>
</body>
</html>